rm(list=ls())
toyotaData = read.csv('toyota.csv')
unique_model = unique(toyotaData$Model)
print(unique_model)
model_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_model)-1))
for( i in 1:(length(unique_model)-1)){
tmp = unique_model[i]
tmp_idx = which(toyotaData$Model == tmp)
model_dummy[tmp_idx,i] = i
colnames(model_dummy)[i] = sprintf("modle_%s",tmp)
}
View(model_dummy)
colnames(model_dummy)[i] = sprintf("model_%s",tmp)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
unique_model = unique(toyotaData$Model)
print(unique_model)
model_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_model)-1))
for( i in 1:(length(unique_model)-1)){
tmp = unique_model[i]
tmp_idx = which(toyotaData$Model == tmp)
model_dummy[tmp_idx,i] = i
colnames(model_dummy)[i] = sprintf("model_%s",tmp)
}
prdata = toyodaData[,-1]
prdata = toyotaData[,-1]
prdata = cbind(model_dummy,prdata)
View(prdata)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
unique_model = unique(toyotaData$Model)
print(unique_model)
model_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_model)-1))
for( i in 1:(length(unique_model)-1)){
tmp = unique_model[i]
tmp_idx = which(toyotaData$Model == tmp)
model_dummy[tmp_idx,i] = i
colnames(model_dummy)[i] = sprintf("model_%s",tmp)
}
prdata = toyotaData[,-1]
prdata = cbind(model_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata[,-1]),round(trn_radio*nrow(prdata)))
tst_idx = setdiff(1:nros(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(price ~., data=trn_data)
fit_lr
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$price, pred_lr
rm(list=ls())
toyotaData = read.csv('toyota.csv')
unique_model = unique(toyotaData$Model)
print(unique_model)
model_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_model)-1))
for( i in 1:(length(unique_model)-1)){
tmp = unique_model[i]
tmp_idx = which(toyotaData$Model == tmp)
model_dummy[tmp_idx,i] = i
colnames(model_dummy)[i] = sprintf("model_%s",tmp)
}
prdata = toyotaData[,-1]
prdata = cbind(model_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata[,-1]),round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nros(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(price ~., data=trn_data)
fit_lr
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$price, pred_lr)
print(trn_idx)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
unique_model = unique(toyotaData$Model)
print(unique_model)
model_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_model)-1))
for( i in 1:(length(unique_model)-1)){
tmp = unique_model[i]
tmp_idx = which(toyotaData$Model == tmp)
model_dummy[tmp_idx,i] = i
colnames(model_dummy)[i] = sprintf("model_%s",tmp)
}
prdata = toyotaData[,-1]
prdata = cbind(model_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata[,-1]),round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nros(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(price ~., data=trn_data)
fit_lr
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$price, pred_lr)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
unique_model = unique(toyotaData$Model)
print(unique_model)
model_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_model)-1))
for( i in 1:(length(unique_model)-1)){
tmp = unique_model[i]
tmp_idx = which(toyotaData$Model == tmp)
model_dummy[tmp_idx,i] = i
colnames(model_dummy)[i] = sprintf("model_%s",tmp)
}
prdata = toyotaData[,-1]
prdata = cbind(model_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata[,-1]),round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nrow(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(price ~., data=trn_data)
fit_lr
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$price, pred_lr)
print(trn_idx)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
unique_model = unique(toyotaData$Model)
print(unique_model)
model_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_model)-1))
for( i in 1:(length(unique_model)-1)){
tmp = unique_model[i]
tmp_idx = which(toyotaData$Model == tmp)
model_dummy[tmp_idx,i] = i
colnames(model_dummy)[i] = sprintf("model_%s",tmp)
}
prdata = toyotaData[,-1]
prdata = cbind(model_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata[,-1]),round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nrow(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(price ~., data=trn_data)
fit_lr
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$price, pred_lr)
View(toyotaData)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
unique_model = unique(toyotaData$Model)
print(unique_model)
model_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_model)-1))
for( i in 1:(length(unique_model)-1)){
tmp = unique_model[i]
tmp_idx = which(toyotaData$Model == tmp)
model_dummy[tmp_idx,i] = i
colnames(model_dummy)[i] = sprintf("model_%s",tmp)
}
prdata = toyotaData[,-1]
prdata = cbind(model_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata[,-1]),round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nrow(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(Price ~., data=trn_data)
fit_lr
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$Price, pred_lr)
pred_lr = predict(fit_lr, tst_data)
View(toyotaData)
View(trn_data)
fit_lr
fit_lr[is.na(x)] <- 0
fit_lr[is.na(fit_lr)] <- 0
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
fit_lr
fit_lr[is.na(fit_lr,*)] = 0
rm(list=ls())
toyotaData = read.csv('toyota.csv')
unique_model = unique(toyotaData$Model)
print(unique_model)
model_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_model)-1))
for( i in 1:(length(unique_model)-1)){
tmp = unique_model[i]
tmp_idx = which(toyotaData$Model == tmp)
model_dummy[tmp_idx,i] = i
colnames(model_dummy)[i] = sprintf("model_%s",tmp)
}
prdata = toyotaData[,-1]
#prdata = cbind(model_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata[,-1]),round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nrow(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(Price ~., data=trn_data)
fit_lr[is.na(fit_lr)] = 0
fit_lr
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$Price, pred_lr)
prdata = toyotaData[,-1]
View(prdata)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
unique_model = unique(toyotaData$Model)
print(unique_model)
model_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_model)-1))
for( i in 1:(length(unique_model)-1)){
tmp = unique_model[i]
tmp_idx = which(toyotaData$Model == tmp)
model_dummy[tmp_idx,i] = i
colnames(model_dummy)[i] = sprintf("model_%s",tmp)
}
prdata = toyotaData[,-1]
#prdata = cbind(model_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata[,-1]),round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nrow(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(Price ~., data=trn_data)
fit_lr[is.na(fit_lr)] = 0
fit_lr
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$Price, pred_lr)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
unique_model = unique(toyotaData$Model)
print(unique_model)
model_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_model)-1))
for( i in 1:(length(unique_model)-1)){
tmp = unique_model[i]
tmp_idx = which(toyotaData$Model == tmp)
model_dummy[tmp_idx,i] = i
colnames(model_dummy)[i] = sprintf("model_%s",tmp)
}
prdata = toyotaData[]
prdata = cbind(model_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata[,-1]),round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nrow(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(Price ~., data=trn_data)
fit_lr[is.na(fit_lr)] = 0
fit_lr
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$Price, pred_lr)
View(toyotaData)
View(fit_lr)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
unique_model = unique(toyotaData$Model)
print(unique_model)
model_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_model)-1))
for( i in 1:(length(unique_model)-1)){
tmp = unique_model[i]
tmp_idx = which(toyotaData$Model == tmp)
model_dummy[tmp_idx,i] = i
colnames(model_dummy)[i] = sprintf("model_%s",tmp)
}
prdata = toyotaData[]
prdata = cbind(model_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata),round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nrow(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(Price ~., data=trn_data)
fit_lr[is.na(fit_lr)] = 0
fit_lr
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$Price, pred_lr)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
unique_model = unique(toyotaData$Model)
print(unique_model)
model_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_model)-1))
for( i in 1:(length(unique_model)-1)){
tmp = unique_model[i]
tmp_idx = which(toyotaData$Model == tmp)
model_dummy[tmp_idx,i] = i
colnames(model_dummy)[i] = sprintf("model_%s",tmp)
}
prdata = toyotaData[,-1]
prdata = cbind(model_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata), round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nrow(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(Price ~., data=trn_data)
fit_lr[is.na(fit_lr)] = 0
fit_lr
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$Price, pred_lr)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
unique_model = unique(toyotaData$Model)
print(unique_model)
model_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_model)-1))
for( i in 1:(length(unique_model)-1)){
tmp = unique_model[i]
tmp_idx = which(toyotaData$Model == tmp)
model_dummy[tmp_idx,i] = i
colnames(model_dummy)[i] = sprintf("model_%s",tmp)
}
prdata = toyotaData[,-1]
prdata = cbind(model_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata), round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nrow(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(Price ~., data=trn_data)
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$Price, pred_lr)
View(trn_data)
View(trn_data)
str(trn_data)
str(tst_data)
View(fit_lr)
str(fit_lr)
summary(fit_lr)
View(toyotaData)
unique_hp = unique(toyotaData$HP)
print(unique_hp)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
unique_hp = unique(toyotaData$HP)
print(unique_hp)
hp_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_hp)-1))
for( i in 1:(length(unique_hp)-1)){
tmp = unique_hp[i]
tmp_idx = which(toyotaData$HP == tmp)
hp_dummy[tmp_idx,i] = i
colnames(hp_dummy)[i] = sprintf("hp_%s",tmp)
}
prdata = toyotaData[,-1]
prdata = cbind(hp_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata), round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nrow(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(Price ~., data=trn_data)
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$Price, pred_lr)
View(trn_data)
View(fit_lr)
View(tst_data)
View(fit_lr)
View(hp_dummy)
toyotaData$Model = NULL
unique_hp = unique(toyotaData$HP)
print(unique_hp)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
toyotaData$Model = NULL
unique_hp = unique(toyotaData$HP)
print(unique_hp)
hp_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_hp)-1))
for( i in 1:(length(unique_hp)-1)){
tmp = unique_hp[i]
tmp_idx = which(toyotaData$HP == tmp)
hp_dummy[tmp_idx,i] = i
colnames(hp_dummy)[i] = sprintf("hp_%s",tmp)
}
prdata = toyotaData[,-1]
prdata = cbind(hp_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata), round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nrow(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(Price ~., data=trn_data)
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$Price, pred_lr)
mse_lr = mean((test_data$Price-pred_lr)^2 )
mse_lr = mean((tst_data$Price-pred_lr)^2 )
plot(tst_data$Price, pred_lr)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
toyotaData$Model = NULL
toyotaData$Color = NULL
toyotaData$Id = NULL
unique_hp = unique(toyotaData$HP)
print(unique_hp)
hp_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_hp)-1))
for( i in 1:(length(unique_hp)-1)){
tmp = unique_hp[i]
tmp_idx = which(toyotaData$HP == tmp)
hp_dummy[tmp_idx,i] = i
colnames(hp_dummy)[i] = sprintf("hp_%s",tmp)
}
prdata = toyotaData[,-1]
prdata = cbind(hp_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata), round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nrow(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(Price ~., data=trn_data)
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$Price, pred_lr)
mse_lr = mean((tst_data$Price-pred_lr)^2 )
View(toyotaData)
prdata = cbind(hp_dummy,prdata)
View(prdata)
prdata = toyotaData[]
prdata = cbind(hp_dummy,prdata)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
toyotaData$Model = NULL
toyotaData$Color = NULL
toyotaData$Id = NULL
unique_hp = unique(toyotaData$HP)
print(unique_hp)
hp_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_hp)-1))
for( i in 1:(length(unique_hp)-1)){
tmp = unique_hp[i]
tmp_idx = which(toyotaData$HP == tmp)
hp_dummy[tmp_idx,i] = i
colnames(hp_dummy)[i] = sprintf("hp_%s",tmp)
}
prdata = toyotaData[]
prdata = cbind(hp_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata), round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nrow(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(Price ~., data=trn_data)
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$Price, pred_lr)
mse_lr = mean((tst_data$Price-pred_lr)^2 )
prdata = toyotaData[:len(toyotaData)-1]
prdata = toyotaData[1:len(toyotaData)-1]
prdata = cbind(hp_dummy,prdata)
prdata = toyotaData[1:length(toyotaData)-1]
prdata = cbind(hp_dummy,prdata)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
toyotaData$Model = NULL
toyotaData$Color = NULL
toyotaData$Id = NULL
unique_hp = unique(toyotaData$HP)
print(unique_hp)
hp_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_hp)-1))
for( i in 1:(length(unique_hp)-1)){
tmp = unique_hp[i]
tmp_idx = which(toyotaData$HP == tmp)
hp_dummy[tmp_idx,i] = i
colnames(hp_dummy)[i] = sprintf("hp_%s",tmp)
}
prdata = toyotaData[1:length(toyotaData)-1]
prdata = cbind(hp_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata), round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nrow(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(Price ~., data=trn_data)
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
plot(tst_data$Price, pred_lr)
mse_lr = mean((tst_data$Price-pred_lr)^2 )
abline(a=1,b=0,col='red')
plot(tst_data$Price, pred_lr)
rm(list=ls())
toyotaData = read.csv('toyota.csv')
toyotaData$Model = NULL
toyotaData$Color = NULL
toyotaData$Id = NULL
x = range(1:max(toyotaData$Price))
y = x
unique_hp = unique(toyotaData$HP)
print(unique_hp)
hp_dummy = as.data.frame(matrix(0, nrow(toyotaData), length(unique_hp)-1))
for( i in 1:(length(unique_hp)-1)){
tmp = unique_hp[i]
tmp_idx = which(toyotaData$HP == tmp)
hp_dummy[tmp_idx,i] = i
colnames(hp_dummy)[i] = sprintf("hp_%s",tmp)
}
prdata = toyotaData[1:length(toyotaData)-1]
prdata = cbind(hp_dummy,prdata)
trn_ratio = .7
trn_idx = sample(1:nrow(prdata), round(trn_ratio*nrow(prdata)))
tst_idx = setdiff(1:nrow(prdata), trn_idx)
trn_data = prdata[trn_idx,]
tst_data = prdata[tst_idx,]
fit_lr = lm(Price ~., data=trn_data)
summary(fit_lr)
pred_lr = predict(fit_lr, tst_data)
abline(a=1,b=0,col='red')
plot(tst_data$Price, pred_lr)
mse_lr = mean((tst_data$Price-pred_lr)^2 )
abline(a=1,b=0,col="red")
abline(a=0,b=1,col="red")
